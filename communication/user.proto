syntax = "proto3";
package main;
option go_package=".;communication";

import "google/protobuf/timestamp.proto";
import "communication/file_service.proto";

message UserRegisterRequest {
    string username = 1;
    string email = 2;
    string password = 3;
    string full_name = 4;
    uint32 user_type = 5;
}

message UserRegisterResponse {
    bool success = 1;
    string error = 2;
    string token = 3;
    google.protobuf.Timestamp token_timeout = 7;

    string username = 4;
    string id = 5;
    uint32 role = 6;
    bool admin_status = 8;
}

message UserLoginRequest {
    string username = 1;
    string password = 2;
}

message UserLoginResponse {
    string Error = 1;
    string token = 3;
    google.protobuf.Timestamp token_timeout = 7;
    string username = 4;
    string id = 5;
    uint32 role = 6;
    bool admin_status = 8;
}

message UserLogoutRequest {
    string username = 1;
    string token = 2;
}

message UserLogoutResponse {
    string Error = 1;
}

message UserPullRequest {
    string user_id = 1;
}

message UserEntity {
    string user_id = 1;
    string username = 2;
    uint32 user_type = 3;
    uint32 role = 14;
    string email = 4;
    string full_name = 5;
    repeated uint32 contract_ids = 6 [packed=true];

    string insta_account = 7;
    uint32 insta_followers = 8;
    bool insta_verified = 9;

    string tiktok_account = 10;
    uint32 tiktok_followers = 11;
    bool tiktok_verified = 12;

    bool payment_setup = 13;

    bool admin_status = 15;
    bool profile_photo_uploaded = 16;

    string profile_photo_id = 17;
    ProfileImageEntity profile_photo = 18;

}

service Auth{
    rpc Register(UserRegisterRequest) returns (UserRegisterResponse) {};
    rpc Login(UserLoginRequest) returns (UserLoginResponse) {};
    rpc Logout(UserLogoutRequest) returns (UserLogoutResponse) {};
    rpc Pull(UserPullRequest) returns (UserEntity) {};
}

message InstagramCreateRequest {
    string user_id = 1;
    string account = 2;
    uint32 followers = 3;
    bool verified = 4;
}

message TiktokCreateRequest {
    string user_id = 1;
    string account = 2;
    uint32 followers = 3;
    bool verified = 4;
}

message InstagramVerifyRequest {
    string user_id = 1;
    string code = 2;
}
message TiktokVerifyRequest {
    string user_id = 1;
    bool code = 2;
}

message SocialResponse {
    string account = 2;
    uint32 followers = 3;
    bool verified = 4;
    string platform = 5;
}
service Social{
    rpc AddInstagram(InstagramCreateRequest) returns (SocialResponse) {};
    rpc AddTiktok(TiktokCreateRequest) returns (SocialResponse) {};
    rpc VerifyInstagram(InstagramVerifyRequest) returns (SocialResponse) {};
    rpc VerifyTiktok(TiktokVerifyRequest) returns (SocialResponse) {};
}

message PaymentSetupRequest {
    string user_id = 1;
    string card_number = 2;
    string card_holder = 3;
    uint32 month = 4;
    uint32 year = 5;
    string zip = 6;
    string CVV = 7;
}

message PaymentSetupResponse {
    bool valid = 1;
}

service Payment {
    rpc SetupPayment(PaymentSetupRequest) returns (PaymentSetupResponse) {};
}
